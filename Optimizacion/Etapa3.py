from gurobipy import Model, GRB
from Etapa2 import lotes_finales_ordenados, lote_info
import numpy as np

# Creación del modelo
m = Model("OptimizacionCosechaLotes")

# Índices
S = []  # Conjunto de lotes comprados con spot
F = [] # Conjunto de lotes comprados con forward
for i in lotes_finales_ordenados:
    if i[15] == 1:
        S.append(i[0])
    elif i[16] == 1:
        F.append(i[0])
print("S",S)
print("F",F)

L = [
    'L_1_C4', 'L_2_C4', 'L_3_C6', 'L_4_C4', 'L_5_C6', 'L_6_C3', 'L_7_C5', 'L_8_C6', 'L_9_C1', 'L_10_C5',
    'L_11_C1', 'L_12_C1', 'L_13_C5', 'L_14_C2', 'L_15_C1', 'L_16_C6', 'L_17_C5', 'L_18_C2', 'L_19_C2', 'L_20_C4',
    'L_21_C5', 'L_22_C1', 'L_23_C3', 'L_24_C5', 'L_25_C3', 'L_26_C6', 'L_27_C6', 'L_28_C3', 'L_29_C1', 'L_30_C4',
    'L_31_C1', 'L_32_C6', 'L_33_C6', 'L_34_C2', 'L_35_C5', 'L_36_C6', 'L_37_C6', 'L_38_C1', 'L_39_C6', 'L_40_C1',
    'L_41_C1', 'L_42_C4', 'L_43_C1', 'L_44_C2', 'L_45_C4', 'L_46_C4', 'L_47_C2', 'L_48_C1', 'L_49_C5', 'L_50_C5',
    'L_51_C1', 'L_52_C2', 'L_53_C6', 'L_54_C2', 'L_55_C2', 'L_56_C2', 'L_57_C5', 'L_58_C4', 'L_59_C5', 'L_60_C4',
    'L_61_C1', 'L_62_C1', 'L_63_C3', 'L_64_C2', 'L_65_C3', 'L_66_C3', 'L_67_C3', 'L_68_C1', 'L_69_C1', 'L_70_C5',
    'L_71_C5', 'L_72_C1', 'L_73_C2', 'L_74_C2', 'L_75_C2', 'L_76_C2', 'L_77_C2', 'L_78_C5', 'L_79_C5', 'L_80_C5',
    'L_81_C5', 'L_82_C2', 'L_83_C5', 'L_84_C1', 'L_85_C4', 'L_86_C5', 'L_87_C3', 'L_88_C1', 'L_89_C6', 'L_90_C6',
    'L_91_C3', 'L_92_C5', 'L_93_C1', 'L_94_C6', 'L_95_C5', 'L_96_C5', 'L_97_C6', 'L_98_C4', 'L_99_C2', 'L_100_C6',
    'L_101_C2', 'L_102_C5', 'L_103_C2', 'L_104_C4', 'L_105_C2', 'L_106_C1', 'L_107_C1', 'L_108_C4', 'L_109_C4',
    'L_110_C3', 'L_111_C3', 'L_112_C1', 'L_113_C1', 'L_114_C3', 'L_115_C3', 'L_116_C3', 'L_117_C1', 'L_118_C6',
    'L_119_C6', 'L_120_C3', 'L_121_C5', 'L_122_C6', 'L_123_C1', 'L_124_C6', 'L_125_C4', 'L_126_C5', 'L_127_C5',
    'L_128_C1', 'L_129_C1', 'L_130_C3', 'L_131_C6', 'L_132_C2', 'L_133_C2', 'L_134_C4', 'L_135_C4', 'L_136_C3',
    'L_137_C1', 'L_138_C1', 'L_139_C6', 'L_140_C3', 'L_141_C5', 'L_142_C5', 'L_143_C2', 'L_144_C4', 'L_145_C2',
    'L_146_C5', 'L_147_C1', 'L_148_C6', 'L_149_C5', 'L_150_C6', 'L_151_C6', 'L_152_C5', 'L_153_C5', 'L_154_C3',
    'L_155_C4', 'L_156_C4', 'L_157_C2', 'L_158_C4', 'L_159_C5', 'L_160_C1', 'L_161_C6', 'L_162_C5', 'L_163_C1',
    'L_164_C5', 'L_165_C4', 'L_166_C4', 'L_167_C4', 'L_168_C2', 'L_169_C2', 'L_170_C5', 'L_171_C3', 'L_172_C1',
    'L_173_C1', 'L_174_C2', 'L_175_C1', 'L_176_C1', 'L_177_C3', 'L_178_C6', 'L_179_C4', 'L_180_C2', 'L_181_C4',
    'L_182_C2', 'L_183_C5', 'L_184_C1', 'L_185_C6', 'L_186_C5', 'L_187_C2', 'L_188_C2', 'L_189_C4', 'L_190_C5',
    'L_191_C1', 'L_192_C1', 'L_193_C6', 'L_194_C4', 'L_195_C5', 'L_196_C2', 'L_197_C1', 'L_198_C3', 'L_199_C5',
    'L_200_C5', 'L_201_C1', 'L_202_C3', 'L_203_C3', 'L_204_C2', 'L_205_C2', 'L_206_C3', 'L_207_C5', 'L_208_C2',
    'L_209_C5', 'L_210_C4', 'L_211_C5', 'L_212_C5', 'L_213_C4', 'L_214_C1', 'L_215_C6', 'L_216_C2', 'L_217_C3',
    'L_218_C4', 'L_219_C4', 'L_220_C4', 'L_221_C6', 'L_222_C6', 'L_223_C2', 'L_224_C2', 'L_225_C4', 'L_226_C2',
    'L_227_C3', 'L_228_C2', 'L_229_C2', 'L_230_C5', 'L_231_C3', 'L_232_C5', 'L_233_C5', 'L_234_C1', 'L_235_C2',
    'L_236_C4', 'L_237_C3', 'L_238_C5', 'L_239_C5', 'L_240_C3', 'L_241_C4', 'L_242_C4', 'L_243_C1', 'L_244_C5',
    'L_245_C5', 'L_246_C1', 'L_247_C6', 'L_248_C1', 'L_249_C4', 'L_250_C3', 'L_251_C6', 'L_252_C6', 'L_253_C6',
    'L_254_C3', 'L_255_C5', 'L_256_C1', 'L_257_C3', 'L_258_C2', 'L_259_C2', 'L_260_C3', 'L_261_C5', 'L_262_C2',
    'L_263_C6', 'L_264_C1', 'L_265_C6', 'L_266_C6', 'L_267_C3', 'L_268_C1', 'L_269_C3', 'L_270_C4', 'L_271_C2',
    'L_272_C1', 'L_273_C6', 'L_274_C1', 'L_275_C4', 'L_276_C1', 'L_277_C3', 'L_278_C5', 'L_279_C4', 'L_280_C2',
    'L_281_C1', 'L_282_C6', 'L_283_C4', 'L_284_C3', 'L_285_C6', 'L_286_C2', 'L_287_C5', 'L_288_C6', 'L_289_C5',
    'L_290_C6'
]
T = list(range(1, 151)) # Periodos
C = ['C1','C2','C3','C4','C5','C6']
calidades = {'C1': [0.85, 0.95], 'C2': [0.92, 0.93], 'C3': [0.91, 0.87], 'C4': [0.95, 0.95], 'C5': [0.85, 0.85],
             'C6': [0.93, 0.94]}


# Parámetros
r_cl = {
    ("C1", "L_9_C1"): 300000,
    ("C1", "L_11_C1"): 555000,
    ("C1", "L_12_C1"): 412500,
    ("C1", "L_15_C1"): 101250,
    ("C1", "L_22_C1"): 420000,
    ("C1", "L_29_C1"): 285000,
    ("C1", "L_31_C1"): 307500,
    ("C1", "L_38_C1"): 183750,
    ("C1", "L_40_C1"): 146250,
    ("C1", "L_41_C1"): 472500,
    ("C1", "L_43_C1"): 108750,
    ("C1", "L_48_C1"): 461250,
    ("C1", "L_51_C1"): 412500,
    ("C1", "L_61_C1"): 333750,
    ("C1", "L_62_C1"): 228750,
    ("C1", "L_68_C1"): 236250,
    ("C1", "L_69_C1"): 187500,
    ("C1", "L_72_C1"): 217500,
    ("C1", "L_84_C1"): 277500,
    ("C1", "L_88_C1"): 390000,
    ("C1", "L_93_C1"): 401250,
    ("C1", "L_106_C1"): 427500,
    ("C1", "L_107_C1"): 367500,
    ("C1", "L_112_C1"): 371250,
    ("C1", "L_113_C1"): 558750,
    ("C1", "L_117_C1"): 378750,
    ("C1", "L_123_C1"): 288750,
    ("C1", "L_128_C1"): 292500,
    ("C1", "L_129_C1"): 150000,
    ("C1", "L_137_C1"): 472500,
    ("C1", "L_138_C1"): 517500,
    ("C1", "L_147_C1"): 277500,
    ("C1", "L_160_C1"): 251250,
    ("C1", "L_163_C1"): 97500,
    ("C1", "L_172_C1"): 521250,
    ("C1", "L_173_C1"): 213750,
    ("C1", "L_175_C1"): 517500,
    ("C1", "L_176_C1"): 131250,
    ("C1", "L_184_C1"): 217500,
    ("C1", "L_191_C1"): 528750,
    ("C1", "L_192_C1"): 150000,
    ("C1", "L_197_C1"): 330000,
    ("C1", "L_201_C1"): 150000,
    ("C1", "L_214_C1"): 498750,
    ("C1", "L_234_C1"): 427500,
    ("C1", "L_243_C1"): 498750,
    ("C1", "L_246_C1"): 551250,
    ("C1", "L_248_C1"): 367500,
    ("C1", "L_256_C1"): 120000,
    ("C1", "L_264_C1"): 525000,
    ("C1", "L_268_C1"): 345000,
    ("C1", "L_272_C1"): 446250,
    ("C1", "L_274_C1"): 416250,
    ("C1", "L_276_C1"): 345000,
    ("C1", "L_281_C1"): 161250,
    ("C2", "L_14_C2"): 498.75 * 1000,
    ("C2", "L_18_C2"): 247.5 * 1000,
    ("C2", "L_19_C2"): 457.5 * 1000,
    ("C2", "L_34_C2"): 135 * 1000,
    ("C2", "L_44_C2"): 367.5 * 1000,
    ("C2", "L_47_C2"): 225 * 1000,
    ("C2", "L_52_C2"): 450 * 1000,
    ("C2", "L_54_C2"): 307.5 * 1000,
    ("C2", "L_55_C2"): 558.75 * 1000,
    ("C2", "L_56_C2"): 483.75 * 1000,
    ("C2", "L_64_C2"): 382.5 * 1000,
    ("C2", "L_73_C2"): 292.5 * 1000,
    ("C2", "L_74_C2"): 142.5 * 1000,
    ("C2", "L_75_C2"): 311.25 * 1000,
    ("C2", "L_76_C2"): 277.5 * 1000,
    ("C2", "L_77_C2"): 423.75 * 1000,
    ("C2", "L_82_C2"): 356.25 * 1000,
    ("C2", "L_99_C2"): 127.5 * 1000,
    ("C2", "L_101_C2"): 191.25 * 1000,
    ("C2", "L_103_C2"): 543.75 * 1000,
    ("C2", "L_105_C2"): 131.25 * 1000,
    ("C2", "L_132_C2"): 442.5 * 1000,
    ("C2", "L_133_C2"): 198.75 * 1000,
    ("C2", "L_143_C2"): 127.5 * 1000,
    ("C2", "L_145_C2"): 183.75 * 1000,
    ("C2", "L_157_C2"): 450 * 1000,
    ("C2", "L_168_C2"): 517.5 * 1000,
    ("C2", "L_169_C2"): 277.5 * 1000,
    ("C2", "L_174_C2"): 187.5 * 1000,
    ("C2", "L_180_C2"): 495 * 1000,
    ("C2", "L_182_C2"): 401.25 * 1000,
    ("C2", "L_187_C2"): 318.75 * 1000,
    ("C2", "L_188_C2"): 243.75 * 1000,
    ("C2", "L_196_C2"): 408.75 * 1000,
    ("C2", "L_204_C2"): 138.75 * 1000,
    ("C2", "L_205_C2"): 468.75 * 1000,
    ("C2", "L_208_C2"): 236.25 * 1000,
    ("C2", "L_216_C2"): 176.25 * 1000,
    ("C2", "L_223_C2"): 502.5 * 1000,
    ("C2", "L_224_C2"): 495 * 1000,
    ("C2", "L_226_C2"): 435 * 1000,
    ("C2", "L_228_C2"): 551.25 * 1000,
    ("C2", "L_229_C2"): 232.5 * 1000,
    ("C2", "L_235_C2"): 168.75 * 1000,
    ("C2", "L_258_C2"): 153.75 * 1000,
    ("C2", "L_259_C2"): 127.5 * 1000,
    ("C2", "L_262_C2"): 461.25 * 1000,
    ("C2", "L_271_C2"): 183.75 * 1000,
    ("C2", "L_280_C2"): 431.25 * 1000,
    ("C2", "L_286_C2"): 247.5 * 1000,
    ("C3", "L_6_C3"): 150 * 1000,
    ("C3", "L_23_C3"): 262.5 * 1000,
    ("C3", "L_25_C3"): 168.75 * 1000,
    ("C3", "L_28_C3"): 382.5 * 1000,
    ("C3", "L_63_C3"): 153.75 * 1000,
    ("C3", "L_65_C3"): 341.25 * 1000,
    ("C3", "L_66_C3"): 108.75 * 1000,
    ("C3", "L_67_C3"): 498.75 * 1000,
    ("C3", "L_87_C3"): 525 * 1000,
    ("C3", "L_91_C3"): 457.5 * 1000,
    ("C3", "L_110_C3"): 551.25 * 1000,
    ("C3", "L_111_C3"): 502.5 * 1000,
    ("C3", "L_114_C3"): 487.5 * 1000,
    ("C3", "L_115_C3"): 431.25 * 1000,
    ("C3", "L_116_C3"): 161.25 * 1000,
    ("C3", "L_120_C3"): 217.5 * 1000,
    ("C3", "L_130_C3"): 142.5 * 1000,
    ("C3", "L_136_C3"): 502.5 * 1000,
    ("C3", "L_140_C3"): 127.5 * 1000,
    ("C3", "L_154_C3"): 367.5 * 1000,
    ("C3", "L_171_C3"): 131.25 * 1000,
    ("C3", "L_177_C3"): 123.75 * 1000,
    ("C3", "L_198_C3"): 378.75 * 1000,
    ("C3", "L_202_C3"): 315 * 1000,
    ("C3", "L_203_C3"): 303.75 * 1000,
    ("C3", "L_206_C3"): 405 * 1000,
    ("C3", "L_217_C3"): 528.75 * 1000,
    ("C3", "L_227_C3"): 112.5 * 1000,
    ("C3", "L_231_C3"): 300 * 1000,
    ("C3", "L_237_C3"): 116.25 * 1000,
    ("C3", "L_240_C3"): 108.75 * 1000,
    ("C3", "L_250_C3"): 510 * 1000,
    ("C3", "L_254_C3"): 165 * 1000,
    ("C3", "L_257_C3"): 438.75 * 1000,
    ("C3", "L_260_C3"): 408.75 * 1000,
    ("C3", "L_267_C3"): 547.5 * 1000,
    ("C3", "L_269_C3"): 337.5 * 1000,
    ("C3", "L_277_C3"): 348.75 * 1000,
    ("C3", "L_284_C3"): 360 * 1000,
    ("C4", "L_1_C4"): 217.5 * 1000,
    ("C4", "L_2_C4"): 517.5 * 1000,
    ("C4", "L_4_C4"): 168.75 * 1000,
    ("C4", "L_20_C4"): 225 * 1000,
    ("C4", "L_30_C4"): 101.25 * 1000,
    ("C4", "L_42_C4"): 352.5 * 1000,
    ("C4", "L_45_C4"): 498.75 * 1000,
    ("C4", "L_46_C4"): 446.25 * 1000,
    ("C4", "L_58_C4"): 165 * 1000,
    ("C4", "L_60_C4"): 510 * 1000,
    ("C4", "L_85_C4"): 195 * 1000,
    ("C4", "L_98_C4"): 408.75 * 1000,
    ("C4", "L_104_C4"): 487.5 * 1000,
    ("C4", "L_108_C4"): 202.5 * 1000,
    ("C4", "L_109_C4"): 165 * 1000,
    ("C4", "L_125_C4"): 138.75 * 1000,
    ("C4", "L_134_C4"): 191.25 * 1000,
    ("C4", "L_135_C4"): 375 * 1000,
    ("C4", "L_144_C4"): 210 * 1000,
    ("C4", "L_155_C4"): 333.75 * 1000,
    ("C4", "L_156_C4"): 131.25 * 1000,
    ("C4", "L_158_C4"): 371.25 * 1000,
    ("C4", "L_165_C4"): 138.75 * 1000,
    ("C4", "L_166_C4"): 142.5 * 1000,
    ("C4", "L_167_C4"): 438.75 * 1000,
    ("C4", "L_179_C4"): 142.5 * 1000,
    ("C4", "L_181_C4"): 116.25 * 1000,
    ("C4", "L_189_C4"): 172.5 * 1000,
    ("C4", "L_194_C4"): 502.5 * 1000,
    ("C4", "L_210_C4"): 495 * 1000,
    ("C4", "L_213_C4"): 472.5 * 1000,
    ("C4", "L_218_C4"): 112.5 * 1000,
    ("C4", "L_219_C4"): 416.25 * 1000,
    ("C4", "L_220_C4"): 228.75 * 1000,
    ("C4", "L_225_C4"): 101.25 * 1000,
    ("C4", "L_236_C4"): 363.75 * 1000,
    ("C4", "L_241_C4"): 322.5 * 1000,
    ("C4", "L_242_C4"): 247.5 * 1000,
    ("C4", "L_249_C4"): 558.75 * 1000,
    ("C4", "L_270_C4"): 101.25 * 1000,
    ("C4", "L_275_C4"): 382.5 * 1000,
    ("C4", "L_279_C4"): 446.25 * 1000,
    ("C4", "L_283_C4"): 277.5 * 1000,
    ("C5", "L_7_C5"): 558.75 * 1000,
    ("C5", "L_10_C5"): 108.75 * 1000,
    ("C5", "L_13_C5"): 547.5 * 1000,
    ("C5", "L_17_C5"): 536.25 * 1000,
    ("C5", "L_21_C5"): 427.5 * 1000,
    ("C5", "L_24_C5"): 363.75 * 1000,
    ("C5", "L_35_C5"): 341.25 * 1000,
    ("C5", "L_49_C5"): 412.5 * 1000,
    ("C5", "L_50_C5"): 540 * 1000,
    ("C5", "L_57_C5"): 232.5 * 1000,
    ("C5", "L_59_C5"): 487.5 * 1000,
    ("C5", "L_70_C5"): 153.75 * 1000,
    ("C5", "L_71_C5"): 487.5 * 1000,
    ("C5", "L_78_C5"): 438.75 * 1000,
    ("C5", "L_79_C5"): 386.25 * 1000,
    ("C5", "L_80_C5"): 303.75 * 1000,
    ("C5", "L_81_C5"): 371.25 * 1000,
    ("C5", "L_83_C5"): 532.5 * 1000,
    ("C5", "L_86_C5"): 262.5 * 1000,
    ("C5", "L_92_C5"): 416.25 * 1000,
    ("C5", "L_95_C5"): 213.75 * 1000,
    ("C5", "L_96_C5"): 296.25 * 1000,
    ("C5", "L_102_C5"): 532.5 * 1000,
    ("C5", "L_121_C5"): 386.25 * 1000,
    ("C5", "L_126_C5"): 187.5 * 1000,
    ("C5", "L_127_C5"): 187.5 * 1000,
    ("C5", "L_141_C5"): 416.25 * 1000,
    ("C5", "L_142_C5"): 480 * 1000,
    ("C5", "L_146_C5"): 551.25 * 1000,
    ("C5", "L_149_C5"): 390 * 1000,
    ("C5", "L_152_C5"): 367.5 * 1000,
    ("C5", "L_153_C5"): 255 * 1000,
    ("C5", "L_159_C5"): 180 * 1000,
    ("C5", "L_162_C5"): 363.75 * 1000,
    ("C5", "L_164_C5"): 506.25 * 1000,
    ("C5", "L_170_C5"): 296.25 * 1000,
    ("C5", "L_183_C5"): 431.25 * 1000,
    ("C5", "L_186_C5"): 453.75 * 1000,
    ("C5", "L_190_C5"): 547.5 * 1000,
    ("C5", "L_195_C5"): 427.5 * 1000,
    ("C5", "L_199_C5"): 307.5 * 1000,
    ("C5", "L_200_C5"): 536.25 * 1000,
    ("C5", "L_207_C5"): 465 * 1000,
    ("C5", "L_209_C5"): 378.75 * 1000,
    ("C5", "L_211_C5"): 543.75 * 1000,
    ("C5", "L_212_C5"): 360 * 1000,
    ("C5", "L_230_C5"): 176.25 * 1000,
    ("C5", "L_232_C5"): 446.25 * 1000,
    ("C5", "L_233_C5"): 431.25 * 1000,
    ("C5", "L_238_C5"): 198.75 * 1000,
    ("C5", "L_239_C5"): 266.25 * 1000,
    ("C5", "L_244_C5"): 251.25 * 1000,
    ("C5", "L_245_C5"): 296.25 * 1000,
    ("C5", "L_255_C5"): 528.75 * 1000,
    ("C5", "L_261_C5"): 393.75 * 1000,
    ("C5", "L_278_C5"): 206.25 * 1000,
    ("C6", "L_3_C6"): 450 * 1000,
    ("C6", "L_5_C6"): 243.75 * 1000,
    ("C6", "L_8_C6"): 442.5 * 1000,
    ("C6", "L_16_C6"): 502.5 * 1000,
    ("C6", "L_26_C6"): 442.5 * 1000,
    ("C6", "L_27_C6"): 168.75 * 1000,
    ("C6", "L_32_C6"): 521.25 * 1000,
    ("C6", "L_33_C6"): 303.75 * 1000,
    ("C6", "L_36_C6"): 450 * 1000,
    ("C6", "L_37_C6"): 330 * 1000,
    ("C6", "L_39_C6"): 161.25 * 1000,
    ("C6", "L_53_C6"): 247.5 * 1000,
    ("C6", "L_89_C6"): 318.75 * 1000,
    ("C6", "L_90_C6"): 105 * 1000,
    ("C6", "L_94_C6"): 371.25 * 1000,
    ("C6", "L_97_C6"): 521.25 * 1000,
    ("C6", "L_100_C6"): 326.25 * 1000,
    ("C6", "L_118_C6"): 547.5 * 1000,
    ("C6", "L_119_C6"): 157.5 * 1000,
    ("C6", "L_122_C6"): 120 * 1000,
    ("C6", "L_124_C6"): 138.75 * 1000,
    ("C6", "L_131_C6"): 198.75 * 1000,
    ("C6", "L_139_C6"): 416.25 * 1000,
    ("C6", "L_148_C6"): 296.25 * 1000,
    ("C6", "L_150_C6"): 513.75 * 1000,
    ("C6", "L_151_C6"): 195 * 1000,
    ("C6", "L_161_C6"): 183.75 * 1000,
    ("C6", "L_178_C6"): 363.75 * 1000,
    ("C6", "L_185_C6"): 547.5 * 1000,
    ("C6", "L_193_C6"): 363.75 * 1000,
    ("C6", "L_215_C6"): 375 * 1000,
    ("C6", "L_221_C6"): 487.5 * 1000,
    ("C6", "L_222_C6"): 457.5 * 1000,
    ("C6", "L_247_C6"): 367.5 * 1000,
    ("C6", "L_251_C6"): 127.5 * 1000,
    ("C6", "L_252_C6"): 176.25 * 1000,
    ("C6", "L_253_C6"): 150 * 1000,
    ("C6", "L_263_C6"): 236.25 * 1000,
    ("C6", "L_265_C6"): 457.5 * 1000,
    ("C6", "L_266_C6"): 532.5 * 1000,
    ("C6", "L_273_C6"): 258.75 * 1000,
    ("C6", "L_282_C6"): 487.5 * 1000

}



d_l = {
    "L_1_C4": 118,
    "L_2_C4": 123,
    "L_3_C6": 79,
    "L_4_C4": 122,
    "L_5_C6": 104,
    "L_6_C3": 96,
    "L_7_C5": 109,
    "L_8_C6": 78,
    "L_9_C1": 125,
    "L_10_C5": 79,
    "L_11_C1": 100,
    "L_12_C1": 124,
    "L_13_C5": 89,
    "L_14_C2": 116,
    "L_15_C1": 127,
    "L_16_C6": 97,
    "L_17_C5": 113,
    "L_18_C2": 91,
    "L_19_C2": 81,
    "L_20_C4": 74,
    "L_21_C5": 75,
    "L_22_C1": 72,
    "L_23_C3": 95,
    "L_24_C5": 115,
    "L_25_C3": 122,
    "L_26_C6": 123,
    "L_27_C6": 121,
    "L_28_C3": 92,
    "L_29_C1": 81,
    "L_30_C4": 75,
    "L_31_C1": 120,
    "L_32_C6": 89,
    "L_33_C6": 100,
    "L_34_C2": 76,
    "L_35_C5": 117,
    "L_36_C6": 82,
    "L_37_C6": 96,
    "L_38_C1": 100,
    "L_39_C6": 80,
    "L_40_C1": 92,
    "L_41_C1": 115,
    "L_42_C4": 129,
    "L_43_C1": 122,
    "L_44_C2": 76,
    "L_45_C4": 89,
    "L_46_C4": 127,
    "L_47_C2": 92,
    "L_48_C1": 101,
    "L_49_C5": 109,
    "L_50_C5": 113,
    "L_51_C1": 103,
    "L_52_C2": 84,
    "L_53_C6": 84,
    "L_54_C2": 75,
    "L_55_C2": 78,
    "L_56_C2": 117,
    "L_57_C5": 76,
    "L_58_C4": 90,
    "L_59_C5": 92,
    "L_60_C4": 74,
    "L_61_C1": 99,
    "L_62_C1": 130,
    "L_63_C3": 95,
    "L_64_C2": 98,
    "L_65_C3": 91,
    "L_66_C3": 127,
    "L_67_C3": 97,
    "L_68_C1": 90,
    "L_69_C1": 116,
    "L_70_C5": 118,
    "L_71_C5": 88,
    "L_72_C1": 101,
    "L_73_C2": 82,
    "L_74_C2": 78,
    "L_75_C2": 93,
    "L_76_C2": 79,
    "L_77_C2": 89,
    "L_78_C5": 98,
    "L_79_C5": 95,
    "L_80_C5": 104,
    "L_81_C5": 115,
    "L_82_C2": 97,
    "L_83_C5": 116,
    "L_84_C1": 130,
    "L_85_C4": 125,
    "L_86_C5": 113,
    "L_87_C3": 76,
    "L_88_C1": 88,
    "L_89_C6": 116,
    "L_90_C6": 123,
    "L_91_C3": 75,
    "L_92_C5": 116,
    "L_93_C1": 95,
    "L_94_C6": 119,
    "L_95_C5": 81,
    "L_96_C5": 93,
    "L_97_C6": 111,
    "L_98_C4": 108,
    "L_99_C2": 88,
    "L_100_C6": 77,
    "L_101_C2": 116,
    "L_102_C5": 99,
    "L_103_C2": 115,
    "L_104_C4": 74,
    "L_105_C2": 107,
    "L_106_C1": 79,
    "L_107_C1": 92,
    "L_108_C4": 83,
    "L_109_C4": 90,
    "L_110_C3": 128,
    "L_111_C3": 113,
    "L_112_C1": 79,
    "L_113_C1": 128,
    "L_114_C3": 84,
    "L_115_C3": 72,
    "L_116_C3": 124,
    "L_117_C1": 121,
    "L_118_C6": 103,
    "L_119_C6": 85,
    "L_120_C3": 71,
    "L_121_C5": 125,
    "L_122_C6": 106,
    "L_123_C1": 89,
    "L_124_C6": 127,
    "L_125_C4": 73,
    "L_126_C5": 71,
    "L_127_C5": 110,
    "L_128_C1": 103,
    "L_129_C1": 118,
    "L_130_C3": 77,
    "L_131_C6": 77,
    "L_132_C2": 110,
    "L_133_C2": 124,
    "L_134_C4": 88,
    "L_135_C4": 111,
    "L_136_C3": 73,
    "L_137_C1": 130,
    "L_138_C1": 88,
    "L_139_C6": 124,
    "L_140_C3": 101,
    "L_141_C5": 86,
    "L_142_C5": 90,
    "L_143_C2": 108,
    "L_144_C4": 128,
    "L_145_C2": 102,
    "L_146_C5": 88,
    "L_147_C1": 116,
    "L_148_C6": 104,
    "L_149_C5": 109,
    "L_150_C6": 80,
    "L_151_C6": 106,
    "L_152_C5": 74,
    "L_153_C5": 118,
    "L_154_C3": 74,
    "L_155_C4": 112,
    "L_156_C4": 89,
    "L_157_C2": 108,
    "L_158_C4": 105,
    "L_159_C5": 121,
    "L_160_C1": 113,
    "L_161_C6": 116,
    "L_162_C5": 130,
    "L_163_C1": 97,
    "L_164_C5": 108,
    "L_165_C4": 83,
    "L_166_C4": 99,
    "L_167_C4": 104,
    "L_168_C2": 124,
    "L_169_C2": 124,
    "L_170_C5": 113,
    "L_171_C3": 97,
    "L_172_C1": 101,
    "L_173_C1": 100,
    "L_174_C2": 126,
    "L_175_C1": 71,
    "L_176_C1": 114,
    "L_177_C3": 75,
    "L_178_C6": 73,
    "L_179_C4": 121,
    "L_180_C2": 79,
    "L_181_C4": 110,
    "L_182_C2": 101,
    "L_183_C5": 80,
    "L_184_C1": 104,
    "L_185_C6": 103,
    "L_186_C5": 96,
    "L_187_C2": 73,
    "L_188_C2": 90,
    "L_189_C4": 90,
    "L_190_C5": 129,
    "L_191_C1": 118,
    "L_192_C1": 84,
    "L_193_C6": 109,
    "L_194_C4": 73,
    "L_195_C5": 124,
    "L_196_C2": 115,
    "L_197_C1": 100,
    "L_198_C3": 103,
    "L_199_C5": 129,
    "L_200_C5": 116,
    "L_201_C1": 82,
    "L_202_C3": 112,
    "L_203_C3": 100,
    "L_204_C2": 78,
    "L_205_C2": 98,
    "L_206_C3": 93,
    "L_207_C5": 127,
    "L_208_C2": 91,
    "L_209_C5": 91,
    "L_210_C4": 108,
    "L_211_C5": 123,
    "L_212_C5": 120,
    "L_213_C4": 105,
    "L_214_C1": 104,
    "L_215_C6": 117,
    "L_216_C2": 95,
    "L_217_C3": 121,
    "L_218_C4": 94,
    "L_219_C4": 85,
    "L_220_C4": 126,
    "L_221_C6": 90,
    "L_222_C6": 129,
    "L_223_C2": 115,
    "L_224_C2": 92,
    "L_225_C4": 130,
    "L_226_C2": 96,
    "L_227_C3": 82,
    "L_228_C2": 113,
    "L_229_C2": 81,
    "L_230_C5": 109,
    "L_231_C3": 74,
    "L_232_C5": 118,
    "L_233_C5": 104,
    "L_234_C1": 90,
    "L_235_C2": 106,
    "L_236_C4": 95,
    "L_237_C3": 121,
    "L_238_C5": 71,
    "L_239_C5": 119,
    "L_240_C3": 130,
    "L_241_C4": 95,
    "L_242_C4": 104,
    "L_243_C1": 84,
    "L_244_C5": 127,
    "L_245_C5": 85,
    "L_246_C1": 127,
    "L_247_C6": 126,
    "L_248_C1": 123,
    "L_249_C4": 121,
    "L_250_C3": 105,
    "L_251_C6": 117,
    "L_252_C6": 106,
    "L_253_C6": 85,
    "L_254_C3": 87,
    "L_255_C5": 91,
    "L_256_C1": 95,
    "L_257_C3": 78,
    "L_258_C2": 121,
    "L_259_C2": 74,
    "L_260_C3": 78,
    "L_261_C5": 82,
    "L_262_C2": 109,
    "L_263_C6": 74,
    "L_264_C1": 121,
    "L_265_C6": 84,
    "L_266_C6": 75,
    "L_267_C3": 124,
    "L_268_C1": 91,
    "L_269_C3": 104,
    "L_270_C4": 123,
    "L_271_C2": 97,
    "L_272_C1": 80,
    "L_273_C6": 96,
    "L_274_C1": 117,
    "L_275_C4": 73,
    "L_276_C1": 112,
    "L_277_C3": 100,
    "L_278_C5": 106,
    "L_279_C4": 128,
    "L_280_C2": 115,
    "L_281_C1": 77,
    "L_282_C6": 101,
    "L_283_C4": 110,
    "L_284_C3": 72,
    "L_285_C6": 128,
    "L_286_C2": 98,
    "L_287_C5": 112,
    "L_288_C6": 83,
    "L_289_C5": 113,
    "L_290_C6": 81
}
d_c = {'C1': 6674413,
    'C2': 16173750,
    'C3': 12480000,
    'C4': 12592500,
    'C5': 14337206,
    'C6': 2002133
} # Cantidad de cepa c requerida / esto varia si varia el resultado de la etapa 1, HABRIA QUE CAMBIARLO MANUAL


u_l = {
    'L_1_C4': 0.7,    # Cepa C4
    'L_2_C4': 0.7,    # Cepa C4
    'L_3_C6': 0.7,    # Cepa C6
    'L_4_C4': 0.7,    # Cepa C4
    'L_5_C6': 0.7,    # Cepa C6
    'L_6_C3': 0.8,    # Cepa C3
    'L_7_C5': 0.8,    # Cepa C5
    'L_8_C6': 0.7,    # Cepa C6
    'L_9_C1': 0.8,    # Cepa C1
    'L_10_C5': 0.8,   # Cepa C5
    'L_11_C1': 0.8,   # Cepa C1
    'L_12_C1': 0.8,   # Cepa C1
    'L_13_C5': 0.8,   # Cepa C5
    'L_14_C2': 0.75,  # Cepa C2
    'L_15_C1': 0.8,   # Cepa C1
    'L_16_C6': 0.7,   # Cepa C6
    'L_17_C5': 0.8,   # Cepa C5
    'L_18_C2': 0.75,  # Cepa C2
    'L_19_C2': 0.75,  # Cepa C2
    'L_20_C4': 0.7,   # Cepa C4
    'L_21_C5': 0.8,   # Cepa C5
    'L_22_C1': 0.8,   # Cepa C1
    'L_23_C3': 0.8,   # Cepa C3
    'L_24_C5': 0.8,   # Cepa C5
    'L_25_C3': 0.8,   # Cepa C3
    'L_26_C6': 0.7,   # Cepa C6
    'L_27_C6': 0.7,   # Cepa C6
    'L_28_C3': 0.8,   # Cepa C3
    'L_29_C1': 0.8,   # Cepa C1
    'L_30_C4': 0.7,   # Cepa C4
    'L_31_C1': 0.8,   # Cepa C1
    'L_32_C6': 0.7,   # Cepa C6
    'L_33_C6': 0.7,   # Cepa C6
    'L_34_C2': 0.75,  # Cepa C2
    'L_35_C5': 0.8,   # Cepa C5
    'L_36_C6': 0.7,   # Cepa C6
    'L_37_C6': 0.7,   # Cepa C6
    'L_38_C1': 0.8,   # Cepa C1
    'L_39_C6': 0.7,   # Cepa C6
    'L_40_C1': 0.8,   # Cepa C1
    'L_41_C1': 0.8,   # Cepa C1
    'L_42_C4': 0.7,   # Cepa C4
    'L_43_C1': 0.8,   # Cepa C1
    'L_44_C2': 0.75,  # Cepa C2
    'L_45_C4': 0.7,   # Cepa C4
    'L_46_C4': 0.7,   # Cepa C4
    'L_47_C2': 0.75,  # Cepa C2
    'L_48_C1': 0.8,   # Cepa C1
    'L_49_C5': 0.8,   # Cepa C5
    'L_50_C5': 0.8,   # Cepa C5
    'L_51_C1': 0.8,   # Cepa C1
    'L_52_C2': 0.75,  # Cepa C2
    'L_53_C6': 0.7,   # Cepa C6
    'L_54_C2': 0.75,  # Cepa C2
    'L_55_C2': 0.75,  # Cepa C2
    'L_56_C2': 0.75,  # Cepa C2
    'L_57_C5': 0.8,   # Cepa C5
    'L_58_C4': 0.7,   # Cepa C4
    'L_59_C5': 0.8,   # Cepa C5
    'L_60_C4': 0.7,   # Cepa C4
    'L_61_C1': 0.8,   # Cepa C1
    'L_62_C1': 0.8,   # Cepa C1
    'L_63_C3': 0.8,   # Cepa C3
    'L_64_C2': 0.75,  # Cepa C2
    'L_65_C3': 0.8,   # Cepa C3
    'L_66_C3': 0.8,   # Cepa C3
    'L_67_C3': 0.8,   # Cepa C3
    'L_68_C1': 0.8,   # Cepa C1
    'L_69_C1': 0.8,   # Cepa C1
    'L_70_C5': 0.8,   # Cepa C5
    'L_71_C5': 0.8,   # Cepa C5
    'L_72_C1': 0.8,   # Cepa C1
    'L_73_C2': 0.75,  # Cepa C2
    'L_74_C2': 0.75,  # Cepa C2
    'L_75_C2': 0.75,  # Cepa C2
    'L_76_C2': 0.75,  # Cepa C2
    'L_77_C2': 0.75,  # Cepa C2
    'L_78_C5': 0.8,   # Cepa C5
    'L_79_C5': 0.8,   # Cepa C5
    'L_80_C5': 0.8,   # Cepa C5
    'L_81_C5': 0.8,   # Cepa C5
    'L_82_C2': 0.75,  # Cepa C2
    'L_83_C5': 0.8,   # Cepa C5
    'L_84_C1': 0.8,   # Cepa C1
    'L_85_C4': 0.7,   # Cepa C4
    'L_86_C5': 0.8,   # Cepa C5
    'L_87_C3': 0.8,   # Cepa C3
    'L_88_C1': 0.8,   # Cepa C1
    'L_89_C6': 0.7,   # Cepa C6
    'L_90_C6': 0.7,   # Cepa C6
    'L_91_C3': 0.8,   # Cepa C3
    'L_92_C5': 0.8,   # Cepa C5
    'L_93_C1': 0.8,   # Cepa C1
    'L_94_C6': 0.7,   # Cepa C6
    'L_95_C5': 0.8,   # Cepa C5
    'L_96_C5': 0.8,   # Cepa C5
    'L_97_C6': 0.7,   # Cepa C6
    'L_98_C4': 0.7,   # Cepa C4
    'L_99_C2': 0.75,  # Cepa C2
    'L_100_C6': 0.7,  # Cepa C6
    'L_101_C2': 0.75,  # Cepa C2
    'L_102_C5': 0.8,   # Cepa C5
    'L_103_C2': 0.75,  # Cepa C2
    'L_104_C4': 0.7,   # Cepa C4
    'L_105_C2': 0.75,  # Cepa C2
    'L_106_C1': 0.8,   # Cepa C1
    'L_107_C1': 0.8,   # Cepa C1
    'L_108_C4': 0.7,   # Cepa C4
    'L_109_C4': 0.7,   # Cepa C4
    'L_110_C3': 0.8,   # Cepa C3
    'L_111_C3': 0.8,   # Cepa C3
    'L_112_C1': 0.8,   # Cepa C1
    'L_113_C1': 0.8,   # Cepa C1
    'L_114_C3': 0.8,   # Cepa C3
    'L_115_C3': 0.8,   # Cepa C3
    'L_116_C3': 0.8,   # Cepa C3
    'L_117_C1': 0.8,   # Cepa C1
    'L_118_C6': 0.7,   # Cepa C6
    'L_119_C6': 0.7,   # Cepa C6
    'L_120_C3': 0.8,   # Cepa C3
    'L_121_C5': 0.8,   # Cepa C5
    'L_122_C6': 0.7,   # Cepa C6
    'L_123_C1': 0.8,   # Cepa C1
    'L_124_C6': 0.7,   # Cepa C6
    'L_125_C4': 0.7,   # Cepa C4
    'L_126_C5': 0.8,   # Cepa C5
    'L_127_C5': 0.8,   # Cepa C5
    'L_128_C1': 0.8,   # Cepa C1
    'L_129_C1': 0.8,   # Cepa C1
    'L_130_C3': 0.8,   # Cepa C3
    'L_131_C6': 0.7,   # Cepa C6
    'L_132_C2': 0.75,  # Cepa C2
    'L_133_C2': 0.75,  # Cepa C2
    'L_134_C4': 0.7,   # Cepa C4
    'L_135_C4': 0.7,   # Cepa C4
    'L_136_C3': 0.8,   # Cepa C3
    'L_137_C1': 0.8,   # Cepa C1
    'L_138_C1': 0.8,   # Cepa C1
    'L_139_C6': 0.7,   # Cepa C6
    'L_140_C3': 0.8,   # Cepa C3
    'L_141_C5': 0.8,   # Cepa C5
    'L_142_C5': 0.8,   # Cepa C5
    'L_143_C2': 0.75,  # Cepa C2
    'L_144_C4': 0.7,   # Cepa C4
    'L_145_C2': 0.75,   # Cepa C2
    'L_146_C5': 0.8,    # Cepa C5
    'L_147_C1': 0.8,    # Cepa C1
    'L_148_C6': 0.7,    # Cepa C6
    'L_149_C5': 0.8,    # Cepa C5
    'L_150_C6': 0.7,    # Cepa C6
    'L_151_C6': 0.7,    # Cepa C6
    'L_152_C5': 0.8,    # Cepa C5
    'L_153_C5': 0.8,    # Cepa C5
    'L_154_C3': 0.8,    # Cepa C3
    'L_155_C4': 0.7,    # Cepa C4
    'L_156_C4': 0.7,    # Cepa C4
    'L_157_C2': 0.75,   # Cepa C2
    'L_158_C4': 0.7,    # Cepa C4
    'L_159_C5': 0.8,    # Cepa C5
    'L_160_C1': 0.8,    # Cepa C1
    'L_161_C6': 0.7,    # Cepa C6
    'L_162_C5': 0.8,    # Cepa C5
    'L_163_C1': 0.8,    # Cepa C1
    'L_164_C5': 0.8,    # Cepa C5
    'L_165_C4': 0.7,    # Cepa C4
    'L_166_C4': 0.7,    # Cepa C4
    'L_167_C4': 0.7,    # Cepa C4
    'L_168_C2': 0.75,   # Cepa C2
    'L_169_C2': 0.75,   # Cepa C2
    'L_170_C5': 0.8,    # Cepa C5
    'L_171_C3': 0.8,    # Cepa C3
    'L_172_C1': 0.8,    # Cepa C1
    'L_173_C1': 0.8,    # Cepa C1
    'L_174_C2': 0.75,   # Cepa C2
    'L_175_C1': 0.8,    # Cepa C1
    'L_176_C1': 0.8,    # Cepa C1
    'L_177_C3': 0.8,    # Cepa C3
    'L_178_C6': 0.7,    # Cepa C6
    'L_179_C4': 0.7,    # Cepa C4
    'L_180_C2': 0.75,   # Cepa C2
    'L_181_C4': 0.7,    # Cepa C4
    'L_182_C2': 0.75,   # Cepa C2
    'L_183_C5': 0.8,    # Cepa C5
    'L_184_C1': 0.8,    # Cepa C1
    'L_185_C6': 0.7,    # Cepa C6
    'L_186_C5': 0.8,    # Cepa C5
    'L_187_C2': 0.75,   # Cepa C2
    'L_188_C2': 0.75,   # Cepa C2
    'L_189_C4': 0.7,    # Cepa C4
    'L_190_C5': 0.8,    # Cepa C5
    'L_191_C1': 0.8,    # Cepa C1
    'L_192_C1': 0.8,    # Cepa C1
    'L_193_C6': 0.7,    # Cepa C6
    'L_194_C4': 0.7,    # Cepa C4
    'L_195_C5': 0.8,    # Cepa C5
    'L_196_C2': 0.75,   # Cepa C2
    'L_197_C1': 0.8,    # Cepa C1
    'L_198_C3': 0.8,    # Cepa C3
    'L_199_C5': 0.8,    # Cepa C5
    'L_200_C5': 0.8,    # Cepa C5
    'L_201_C1': 0.8,    # Cepa C1
    'L_202_C3': 0.8,    # Cepa C3
    'L_203_C3': 0.8,    # Cepa C3
    'L_204_C2': 0.75,   # Cepa C2
    'L_205_C2': 0.75,   # Cepa C2
    'L_206_C3': 0.8,    # Cepa C3
    'L_207_C5': 0.8,    # Cepa C5
    'L_208_C2': 0.75,   # Cepa C2
    'L_209_C5': 0.8,    # Cepa C5
    'L_210_C4': 0.7,    # Cepa C4
    'L_211_C5': 0.8,    # Cepa C5
    'L_212_C5': 0.8,    # Cepa C5
    'L_213_C4': 0.7,    # Cepa C4
    'L_214_C1': 0.8,    # Cepa C1
    'L_215_C6': 0.7,    # Cepa C6
    'L_216_C2': 0.75,   # Cepaa C2
    'L_217_C3': 0.8,  # Cepa C3
    'L_218_C4': 0.7,  # Cepa C4
    'L_219_C4': 0.7,  # Cepa C4
    'L_220_C4': 0.7,  # Cepa C4
    'L_221_C6': 0.7,  # Cepa C6
    'L_222_C6': 0.7,  # Cepa C6
    'L_223_C2': 0.75,  # Cepa C2
    'L_224_C2': 0.75,  # Cepa C2
    'L_225_C4': 0.7,  # Cepa C4
    'L_226_C2': 0.75,  # Cepa C2
    'L_227_C3': 0.8,  # Cepa C3
    'L_228_C2': 0.75,  # Cepa C2
    'L_229_C2': 0.75,  # Cepa C2
    'L_230_C5': 0.8,  # Cepa C5
    'L_231_C3': 0.8,  # Cepa C3
    'L_232_C5': 0.8,  # Cepa C5
    'L_233_C5': 0.8,  # Cepa C5
    'L_234_C1': 0.8,  # Cepa C1
    'L_235_C2': 0.75,  # Cepa C2
    'L_236_C4': 0.7,  # Cepa C4
    'L_237_C3': 0.8,  # Cepa C3
    'L_238_C5': 0.8,  # Cepa C5
    'L_239_C5': 0.8,  # Cepa C5
    'L_240_C3': 0.8,  # Cepa C3
    'L_241_C4': 0.7,  # Cepa C4
    'L_242_C4': 0.7,  # Cepa C4
    'L_243_C1': 0.8,  # Cepa C1
    'L_244_C5': 0.8,  # Cepa C5
    'L_245_C5': 0.8,  # Cepa C5
    'L_246_C1': 0.8,  # Cepa C1
    'L_247_C6': 0.7,  # Cepa C6
    'L_248_C1': 0.8,  # Cepa C1
    'L_249_C4': 0.7,  # Cepa C4
    'L_250_C3': 0.8,  # Cepa C3
    'L_251_C6': 0.7,  # Cepa C6
    'L_252_C6': 0.7,  # Cepa C6
    'L_253_C6': 0.7,  # Cepa C6
    'L_254_C3': 0.8,  # Cepa C3
    'L_255_C5': 0.8,  # Cepa C5
    'L_256_C1': 0.8,  # Cepa C1
    'L_257_C3': 0.8,  # Cepa C3
    'L_258_C2': 0.75,  # Cepa C2
    'L_259_C2': 0.75,  # Cepa C2
    'L_260_C3': 0.8,  # Cepa C3
    'L_261_C5': 0.8,  # Cepa C5
    'L_262_C2': 0.75,  # Cepa C2
    'L_263_C6': 0.7,  # Cepa C6
    'L_264_C1': 0.8,  # Cepa C1
    'L_265_C6': 0.7,  # Cepa C6
    'L_266_C6': 0.7,  # Cepa C6
    'L_267_C3': 0.8,  # Cepa C3
    'L_268_C1': 0.8,  # Cepa C1
    'L_269_C3': 0.8,  # Cepa C3
    'L_270_C4': 0.7,  # Cepa C4
    'L_271_C2': 0.75,  # Cepa C2
    'L_272_C1': 0.8,  # Cepa C1
    'L_273_C6': 0.7,  # Cepa C6
    'L_274_C1': 0.8,  # Cepa C1
    'L_275_C4': 0.7,  # Cepa C4
    'L_276_C1': 0.8,  # Cepa C1
    'L_277_C3': 0.8,  # Cepa C3
    'L_278_C5': 0.8,  # Cepa C5
    'L_279_C4': 0.7,  # Cepa C4
    'L_280_C2': 0.75,  # Cepa C2
    'L_281_C1': 0.8,  # Cepa C1
    'L_282_C6': 0.7,  # Cepa C6
    'L_283_C4': 0.7,  # Cepa C4
    'L_284_C3': 0.8,  # Cepa C3
    'L_285_C6': 0.7,  # Cepa C6
    'L_286_C2': 0.75,  # Cepa C2
    'L_287_C5': 0.8,  # Cepa C5
    'L_288_C6': 0.7,  # Cepa C6
    'L_289_C5': 0.8,  # Cepa C5
    'L_290_C6': 0.7  # Cepa C6
} # Umbral de industrialización del lote l
q_lt = {} # Calidad del lote l en el periodo t


#Actualizar los dias optimos de cada lote incluyendo variabilidad

def dia_estimado():
    optimal_day = np.random.normal(0, 2)
    return int(round(optimal_day))

for clave, valor in d_l.items():
    d_l[clave] = valor + dia_estimado()


def obtener_coeficientes(tipo_uva):
    q_t_minus = calidades[tipo_uva][0]
    q_t_plus = calidades[tipo_uva][1]
    t_minus = -7
    t_plus = 7
    A = np.array([
        [t_minus ** 2, t_minus, 1],
        [0, 0, 1],
        [t_plus ** 2, t_plus, 1]])
    b = np.array([q_t_minus, 1, q_t_plus])
    coefficients = np.linalg.solve(A, b)
    a, b, c = coefficients
    return a, b, c


def funcion_cuadratica_calidad(tipo_uva, t,l):
    a, b, c = obtener_coeficientes(tipo_uva)
    x = a * t ** 2 + b * t + c
    calidad = max(min(x*lotes_finales_ordenados[l][12], 1),0)
    return calidad


for l in range(0,len(L)):
    tipo_uva = L[l][(len(L[l]) - 2):len(L[l])]
    tipo_uva_con_comillas = "'" + tipo_uva + "'"
    for t in T:
        if (d_l[L[l]] - 7) <= t <= (d_l[L[l]]) + 7:
            calidad_dia_final = funcion_cuadratica_calidad(tipo_uva, (t - (d_l[L[l]])), l)
            q_lt[L[l], t] = calidad_dia_final
        else:
            q_lt[L[l], t] = 0


# Variables de Decisión
x_lt = m.addVars(L, T, vtype=GRB.BINARY, name="x")
y_lt = m.addVars(L, T, vtype=GRB.BINARY, name="x")
xd_lt = m.addVars(L, T, vtype=GRB.BINARY, name="xd")
z_lt = m.addVars(L,T, vtype=GRB.BINARY, name="z")
dc_l = m.addVars(L, vtype=GRB.CONTINUOUS, name="dc")
w_ct = m.addVars(C, T, vtype=GRB.CONTINUOUS, name="w")

# Función Objetivo
m.setObjective(sum(q_lt[l, t]*x_lt[l, t] for l in L for t in T), GRB.MAXIMIZE)

# Restricciones
for l in S:
    m.addConstr(d_l[l] - dc_l[l] == 2, name=f"restr1_{l}")

for l in F:
    m.addConstr(d_l[l] - dc_l[l] >= 5, name=f"restr2_{l}")

for l in L:
    m.addConstr(sum(x_lt[l, t] + xd_lt[l, t] for t in T) == 1, name=f"restr3_{l}")

for f in C:
    for t in T:
        m.addConstr(sum(z_lt[l, t] * r_cl[f,l] for c, l in r_cl if l in L and  c == f) == w_ct[f, t], name=f"restr5_{f}_{t}")

for f in C:
    m.addConstr(sum(z_lt[l, t] * r_cl[f,l]  for c, l in r_cl if l in L and  c == f for t in T) >= d_c[f], name=f"restr6_{f}")

# Agrega restricciones para calcular la calidad en función del día de cosecha --------
#----------------------------------

for l in L:
    for t in T:
        m.addConstr(0 <= (q_lt[l, t] - u_l[l])* z_lt[l,t])

# Suponiendo que 'm' es el modelo de Gurobi
for l in L:
    for t in T:
        m.addConstr(y_lt[l, t] <= x_lt[l, t], name=f"Restriction_y_x_{l}_{t}")

for l in L:
    m.addConstr(sum(z_lt[l,t] for t in T) <= 1, name=f"restr3_{l}")


# Suponiendo que 'm' es el modelo de Gurobi
for l in L:
    for t in T:
        m.addConstr(y_lt[l, t] >= z_lt[l,t], name=f"Restriction_y_z_{l}_{t}")

# Suponiendo que 'm' es el modelo de Gurobi
for l in L:
    for t in T:
        m.addConstr(y_lt[l, t] >= x_lt[l, t] + z_lt[l,t] - 1, name=f"Restriction_y_x_z_{l}_{t}")

# Resolver el modelo
m.optimize()

# Imprimir solución (esto es opcional)
if m.status == GRB.OPTIMAL:
    for l in L:
        for t in T:
            if x_lt[l, t].x == 1:
                print(t)
                print(f"x_{l}_{t}:", x_lt[l, t].x, f" Cantidad de kilo del lote, pta no alcanze a definirlo se podria sacar de forma manual desde r_cl")




